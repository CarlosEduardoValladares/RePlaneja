<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="UTF-8">
		<script src="jquery.js"></script>
		<script src="bootstrap4/js/bootstrap.js"></script>
		<script src="posts.js"></script>
		<link rel="stylesheet" href="bootstrap4/css/bootstrap.css">
		<link rel="stylesheet" href="style.css">
		</link>
		<script>
		
			function comparar(a, b){
			
				a = parseInt(a[0], 10);
				b = parseInt(b[0], 10);
				return( a - b );
			
			}

			function upVote(id_post){

				var total = document.getElementById(id_post).innerHTML;
				total = parseInt(total);
				total++;
				document.getElementById(id_post).innerHTML = total;

			}

			function downVote(id_post){

				var total = document.getElementById(id_post).innerHTML;
				total = parseInt(total);
				total--;
				document.getElementById(id_post).innerHTML = total;

			}

			function orderByMostRecent(){

				var listaPosts = document.getElementsByClassName("postagem");
				var i;
				var size = listaPosts.length;
				var indexMap = [];
				for (i = 0; i < size; i++){

					var spanPost = listaPosts[i].getElementsByTagName("span");
					var id = spanPost[0].id;
					var stringSize = id.length;
					var lastChar = id.charAt(stringSize-1);
					indexMap.push( [lastChar, i] );

				}

				indexMap.sort(comparar); 
				
				var cpyListPosts = [];
				for(i = 0; i < size; i++){
					cpyListPosts.push(listaPosts[i].innerHTML);	
				}
	
				var iterador = 0;
				$("#posts").children(".postagem").each(function (){
				
					var post = $(this);
					var index = indexMap[iterador][1];
					post.html(cpyListPosts[index]);
					iterador++;
				
				});

			}

			function orderByVote(){

				var listaPosts = document.getElementsByClassName("postagem");
				var i;
				var size = listaPosts.length;
				var listaVal = [];
				var indexMap = [];
				for (i = 0; i < size; i++){

					var spanPost = listaPosts[i].getElementsByTagName("span");
					var id = spanPost[0].id;
					var val = spanPost[0].innerText;
					listaVal.push(val);
					indexMap.push( [val, i] );

				}

				indexMap = indexMap.sort(comparar);

				var cpyListPosts = [];
				for(i = 0; i < size; i++){
					cpyListPosts.push(listaPosts[i].innerHTML);
				}
	
				var iterador = 0;
				$("#posts").children(".postagem").each(function (){
				
					var post = $(this);
					var index = indexMap[size-1-iterador][1];
					post.html(cpyListPosts[index]);
					iterador++;
				
				});

			}

			$(function(){
			
				var posts = $(postsList.posts);
				var i = 1;
				posts.each(function(){
				
					$("#posts").append(
					
						allBeforeName +
						this.autor +
						allBeforePostNumber +
						i +
						allBeforePostTitle +
						this.titulo +
						allBeforeSpanId +
						i +
						allBeforeUpId +
						i +
						allBeforeDownId +
						i +
						allBeforeDescription +
						this.descricao +
						stringEnd
					
					);
					i++;
				
				});			
			});

		</script>
		<title>RePlaneja</title>
	</head>
	<body class="bg-secondary text-white index-body">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<a class="nav-link font-weight-bold" href="index.html">RePlaneja</a>
			<div class="collapse navbar-collapse">
				<form class="form-inline ml-auto">
					<input class="form-control mr-sm-3 input-xxlarge" type="search" placeholder="Search" aria-label="Search">
					<button class="btn btn-outline-success mr-sm-2" type="submit">Search</button>
				</form>
				<a class="nav-link" href="signin.html">Login<span class="sr-only">(current)</span></a>
				<a class="nav-link" href="cadastro.html">Cadastre-se<span class="sr-only">(current)</span></a>
			</div>
		</nav>
		<div class="container bg-dark mt-5 pt-1 pb-1 border rounded">
			<div class="row mt-1">
				<div class="col-sm-6">
					<a href="adicionar-plano.html"><button class="btn btn-success">+ Adcionar Novo Plano</button></a>
				</div>
				<div class="col-sm-6 d-flex justify-content-end">
					<label class=" d-flex align-items-end">Ordenar por:</label>
					<button class="btn btn-primary ml-sm-1" onClick="orderByVote();">Mais bem avaliados</button>
					<button class="btn btn-primary ml-sm-1" onClick="orderByMostRecent();">Mais recentes</button>
				</div>
			</div>
			<div id="posts">
				
			</div>
		</div>
	</body>
</html>
